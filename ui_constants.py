"""
–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –±–æ—Ç–∞
"""

# –≠–º–æ–¥–∑–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –∏ —Å—Ç–∞—Ç—É—Å–æ–≤
EMOJI = {
    # –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤
    'new': 'üÜï',
    'assigned': 'üë®‚Äçüîß',
    'in_progress': 'üîß',
    'completed': '‚úÖ',
    'cancelled': '‚ùå',
    
    # –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    'admin': 'üëë',
    'dispatcher': 'üìã',
    'technician': 'üîß',
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∫–æ–Ω–∫–∏ –¥–ª—è —Ä–∞–∑–¥–µ–ª–æ–≤
    'main_menu': 'üè†',
    'orders': 'üìù',
    'users': 'üë•',
    'settings': '‚öôÔ∏è',
    'back': 'üîô',
    'help': '‚ùì',
    'logs': 'üìä',
    'notification': 'üîî',
    'phone': 'üì±',
    'address': 'üè†',
    'date': 'üìÖ',
    'time': 'üïí',
    'cost': 'üí∞',
    'description': 'üìÑ',
    'filter': 'üîç',
    'add': '‚ûï',
    'delete': 'üóëÔ∏è',
    'edit': '‚úèÔ∏è',
    'approve': '‚úÖ',
    'reject': '‚ùå',
    'warning': '‚ö†Ô∏è',
    'error': '‚ùó',
    'success': '‚úÖ',
    'info': '‚ÑπÔ∏è',
}

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π
HEADER_STYLE = "===== {} =====\n"
DIVIDER = "\n‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî\n"
BULLET = "‚Ä¢ "
NUMBERED = "{}. "
BOLD = "*{}*"
ITALIC = "_{}_"
CODE = "`{}`"

# –ú–µ—Ç–∫–∏ –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π
ACTION_LABELS = {
    'order_create': '–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞',
    'order_update': '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞',
    'order_delete': '–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞',
    'status_update': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞',
    'technician_assign': '–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–∞',
    'cost_update': '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏',
    'description_update': '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è —Ä–∞–±–æ—Ç',
    'user_add': '–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
    'user_delete': '–£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
    'user_approve': '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
    'user_reject': '–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
    'role_update': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–∏',
}

# –£–ª—É—á—à–µ–Ω–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤
STATUS_DESCRIPTIONS = {
    'new': '–ù–æ–≤—ã–π –∑–∞–∫–∞–∑, –æ–∂–∏–¥–∞–µ—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –º–∞—Å—Ç–µ—Ä–∞',
    'assigned': '–ó–∞–∫–∞–∑ –Ω–∞–∑–Ω–∞—á–µ–Ω –º–∞—Å—Ç–µ—Ä—É, –æ–∂–∏–¥–∞–µ—Ç –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç',
    'in_progress': '–ú–∞—Å—Ç–µ—Ä –ø—Ä–∏—Å—Ç—É–ø–∏–ª –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –∑–∞–∫–∞–∑–∞',
    'completed': '–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω',
    'cancelled': '–ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω–µ–Ω'
}

def format_order_card(order, include_cost=True, include_description=True):
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É –∑–∞–∫–∞–∑–∞ –¥–ª—è –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    
    Args:
        order: –°–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏ –∑–∞–∫–∞–∑–∞
        include_cost: –í–∫–ª—é—á–∞—Ç—å –ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
        include_description: –í–∫–ª—é—á–∞—Ç—å –ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç
        
    Returns:
        –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∑–∞–∫–∞–∑–µ
    """
    status = order.get('status', 'new')
    status_emoji = EMOJI.get(status, '')
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å ID –∏ —Å—Ç–∞—Ç—É—Å–æ–º
    order_id = order.get('order_id', '')
    status = order.get('status', 'new')
    status_descr = STATUS_DESCRIPTIONS.get(status, '–°—Ç–∞—Ç—É—Å –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω')
    result = f"{BOLD.format('–ó–∞–∫–∞–∑ #' + str(order_id))} {status_emoji} {ITALIC.format(status_descr)}\n\n"
    
    # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ
    client_name = order.get('client_name', '–ù/–î')
    client_phone = order.get('client_phone', '–ù/–î')
    client_address = order.get('client_address', '–ù/–î')
    result += f"{EMOJI['phone']} *–ö–ª–∏–µ–Ω—Ç:* {client_name}\n"
    result += f"{EMOJI['phone']} *–¢–µ–ª–µ—Ñ–æ–Ω:* {client_phone}\n"
    result += f"{EMOJI['address']} *–ê–¥—Ä–µ—Å:* {client_address}\n"
    
    # –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è
    if order.get('scheduled_datetime'):
        scheduled_time = order.get('scheduled_datetime').strftime('%d.%m.%Y %H:%M')
        result += f"{EMOJI['date']} *–î–∞—Ç–∞ –≤–∏–∑–∏—Ç–∞:* {scheduled_time}\n"
    
    # –ü—Ä–æ–±–ª–µ–º–∞
    problem_descr = order.get('problem_description', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')
    result += f"\n{EMOJI['description']} *–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:*\n{problem_descr}\n"
    
    # –°—Ç–æ–∏–º–æ—Å—Ç—å (–µ—Å–ª–∏ –∑–∞–ø—Ä–æ—à–µ–Ω–∞ –∏ –µ—Å—Ç—å)
    if include_cost and order.get('service_cost'):
        service_cost = order.get('service_cost')
        result += f"\n{EMOJI['cost']} *–°—Ç–æ–∏–º–æ—Å—Ç—å —É—Å–ª—É–≥:* {service_cost} —Ä—É–±.\n"
    
    # –û–ø–∏—Å–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç (–µ—Å–ª–∏ –∑–∞–ø—Ä–æ—à–µ–Ω–æ –∏ –µ—Å—Ç—å)
    if include_description and order.get('service_description'):
        service_descr = order.get('service_description')
        result += f"\n{EMOJI['description']} *–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã:*\n{service_descr}\n"
    
    return result


def get_welcome_message(user_name):
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    
    Args:
        user_name: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        
    Returns:
        –°—Ç—Ä–æ–∫–∞ —Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
    """
    return f"""
{EMOJI['info']} –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {BOLD.format(user_name)}!

–≠—Ç–æ—Ç –±–æ—Ç –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–∫–∞–∑–∞–º–∏ –Ω–∞ —Ä–µ–º–æ–Ω—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–∏.

{EMOJI['help']} –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ /help –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø—Ä–∞–≤–∫–∏.
"""

def format_error_message(message):
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
    
    Args:
        message: –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ
        
    Returns:
        –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ–± –æ—à–∏–±–∫–µ
    """
    return f"{EMOJI['error']} {BOLD.format('–û—à–∏–±–∫–∞')}: {message}"

def format_success_message(message):
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
    
    Args:
        message: –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
        
    Returns:
        –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ–± —É—Å–ø–µ—Ö–µ
    """
    return f"{EMOJI['success']} {BOLD.format('–£—Å–ø–µ—à–Ω–æ')}: {message}"

def format_warning_message(message):
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
    
    Args:
        message: –¢–µ–∫—Å—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
        
    Returns:
        –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º
    """
    return f"{EMOJI['warning']} {BOLD.format('–í–Ω–∏–º–∞–Ω–∏–µ')}: {message}"

def format_info_message(message):
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    
    Args:
        message: –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
        
    Returns:
        –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
    """
    return f"{EMOJI['info']} {message}"

def format_help_section(title, items):
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Ä–∞–∑–¥–µ–ª —Å–ø—Ä–∞–≤–∫–∏
    
    Args:
        title: –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–∞–∑–¥–µ–ª–∞
        items: –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å –∫–ª—é—á–∞–º–∏ 'command' –∏ 'description'
        
    Returns:
        –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ —Å —Ä–∞–∑–¥–µ–ª–æ–º —Å–ø—Ä–∞–≤–∫–∏
    """
    result = f"{BOLD.format(title)}:\n"
    
    for item in items:
        result += f"{BULLET}{CODE.format(item['command'])} - {item['description']}\n"
    
    return result + "\n"