# Telegram Бот для Сервиса Ремонта Компьютеров

Этот бот помогает управлять заказами на ремонт компьютерной техники, обеспечивая взаимодействие между диспетчерами, техниками и администраторами.

## Функциональность

- **Система Ролей**:
  - **Администратор**: Полный доступ к системе, управление пользователями, подтверждение заявок
  - **Диспетчер**: Создание и управление заказами, наблюдение за их выполнением
  - **Техник**: Получение заказов, обновление статуса, добавление стоимости и описания работ

- **Управление заказами**:
  - Создание новых заказов с информацией о клиенте и проблеме
  - Назначение техников на заказы
  - Отслеживание статуса (новый, назначен, в работе, завершен, отменен)
  - Добавление стоимости услуг и описания выполненных работ

- **Безопасность**:
  - Система подтверждения пользователей администратором
  - Разграничение доступа в зависимости от роли
  - Первый зарегистрированный пользователь автоматически становится администратором

## Как использовать

1. **Начало работы**:
   - Найдите бота в Telegram (с помощью имени, которое вы указали при создании бота через BotFather)
   - Отправьте команду `/start`
   - Первый пользователь автоматически становится администратором
   - Последующие пользователи нуждаются в подтверждении администратором

2. **Команды**:
   - `/start` - Начать работу с ботом
   - `/help` - Показать справку
   - `/new_order` - Создать новый заказ (для диспетчеров)
   - `/my_orders` - Просмотр созданных заказов (для диспетчеров)
   - `/my_assigned_orders` - Просмотр назначенных заказов (для техников)
   - `/all_orders` - Просмотр всех заказов (для администраторов)
   - `/manage_users` - Управление пользователями (для администраторов)
   - `/order_<id>` - Просмотр конкретного заказа по ID

## Рабочий процесс

1. **Диспетчер**:
   - Принимает звонок от клиента
   - Создает новый заказ в системе
   - Вводит информацию о клиенте (телефон, имя, адрес)
   - Описывает проблему

2. **Администратор**:
   - Получает уведомление о новом заказе
   - Назначает заказ подходящему технику
   - Контролирует процесс выполнения

3. **Техник**:
   - Получает уведомление о новом назначенном заказе
   - Принимает заказ и меняет статус на "В работе"
   - После выполнения добавляет стоимость услуг и описание работ
   - Завершает заказ

## Установка и настройка

1. Создайте нового бота с помощью [BotFather](https://t.me/botfather) и получите токен
2. Установите переменную окружения `TELEGRAM_BOT_TOKEN` 
3. Запустите бота командой `python main.py`

## Техническая информация

- **Язык программирования**: Python
- **База данных**: PostgreSQL
- **Библиотеки**: pyTelegramBotAPI, Flask, psycopg2
- **Структура проекта**:
  - `main.py` - Главный файл для запуска бота
  - `app.py` - Flask-приложение для веб-интерфейса
  - `bot.py` - Обработчики команд и сообщений Telegram
  - `database.py` - Функции для работы с базой данных
  - `models.py` - Модели данных
  - `utils.py` - Вспомогательные функции и инструменты
  - `config.py` - Константы и конфигурации

## Система подтверждения пользователей

В целях безопасности в боте реализована система подтверждения пользователей администратором:

1. Новый пользователь отправляет команду `/start`
2. Пользователь регистрируется в системе, но не имеет доступа к функциям
3. Администратор получает уведомление о новом пользователе
4. Через команду `/manage_users` администратор видит запросы на подтверждение
5. Администратор может подтвердить или отклонить пользователя
6. После подтверждения пользователь получает доступ к функциям в соответствии с ролью